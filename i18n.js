import i18n from "i18next"
import { initReactI18next } from "react-i18next"
import * as Localization from "expo-localization"
import AsyncStorage from "@react-native-async-storage/async-storage"

// English translations
const enTranslations = {
  common: {
    appName: "Zameen Zarien",
    login: "Login",
    register: "Register",
    forgotPassword: "Forgot Password?",
    mobileNumber: "Mobile Number",
    password: "Password",
    email: "Email",
    save: "Save",
    cancel: "Cancel",
    delete: "Delete",
    edit: "Edit",
    search: "Search",
    filter: "Filter",
    download: "Download",
    viewDetails: "View Details",
    createAccount: "Create Account",
    contactSupport: "Contact Support",
    termsAndConditions: "Terms and Conditions",
    privacyPolicy: "Privacy Policy",
    loading: "Loading...",
    date: "Date",
    add: "Add",
    language: "en",
    and: "and",
    ok: "OK",
  },
  dashboard: {
    title: "Dashboard",
    currentPrice: "Current Price",
    highestPrice: "Highest",
    lowestPrice: "Lowest",
    averagePrice: "Average",
    commodity: "Commodity",
    timePeriod: "Time Period",
    dataSource: "Data Source",
    exportData: "Export Data",
    setAlert: "Set Alert",
    viewHistorical: "View Historical Data",
    viewForecast: "View Forecast",
    day: "Day",
    week: "Week",
    month: "Month",
    year: "Year",
    priceHistory: "Price History",
  },
  forecast: {
    title: "Price Forecast",
    predictedPrice: "Predicted Price",
    confidenceInterval: "Confidence Interval",
    forecastDuration: "Forecast Duration",
    days: "Days",
    weeks: "Weeks",
    months: "Months",
    compareHistorical: "Compare with Historical",
    downloadReport: "Download Report",
    showConfidenceInterval: "Show Confidence Interval",
    forecastDetails: "Forecast Details",
    confidenceMin: "Min",
    confidenceMax: "Max",
  },
  alerts: {
    title: "Price Alerts",
    addAlert: "Add Alert",
    editAlert: "Edit Alert",
    deleteAlert: "Delete Alert",
    priceThreshold: "Price Threshold",
    notificationMethod: "Notification Method",
    push: "Push Notification",
    sms: "SMS",
    email: "Email",
    enableAlert: "Enable Alert",
    disableAlert: "Disable Alert",
    alertHistory: "Alert History",
    activeAlerts: "Active Alerts",
    noActiveAlerts: "No active alerts. Add one to get started!",
    noAlertHistory: "No alert history yet.",
    condition: "Condition",
    above: "Above",
    below: "Below",
    createdOn: "Created On",
    triggeredOn: "Triggered On",
    actualPrice: "Actual Price",
    triggered: "Triggered",
    recreate: "Recreate Alert",
    confirmDelete: "Delete Alert",
    confirmDeleteMessage: "Are you sure you want to delete this alert?",
    validationError: "Validation Error",
    allFieldsRequired: "Please fill in all required fields.",
    selectCommodity: "Select a commodity",
    currentPrice: "Current Price",
    notificationMethods: "Notification Methods",
    disabled: "Disabled",
    enterThreshold: "Please enter a price threshold",
    saveAlert: "Save Alert",
    updateAlert: "Update Alert",
    alertDetails: "Alert Details",
    savedAlerts: "Saved Alerts",
    notifyMe: "Notify me when",
    notifyMeWhen: "Notify me when price goes",
    enabledStatus: "Alert Status",
    enabled: "Enabled",
    priceGoes: "Price goes",
    selectNotificationMethods: "Select notification methods",
    setNewAlert: "Set New Alert",
    notActive: "Not Active",
    active: "Active",
    save: "Save",
    close: "Close",
    addNotification: "Add Notification",
    at: "at",
    triggerStatus: "Trigger Status",
    notTriggered: "Not Triggered",
    lastChecked: "Last Checked",
    price: "Price",
    status: "Status",
  },
  settings: {
    title: "Settings",
    language: "Language",
    accountInfo: "Account Information",
    notificationPreferences: "Notification Preferences",
    defaultCommodity: "Default Commodity",
    defaultView: "Default View",
    resetSettings: "Reset Settings",
    defaultDashboard: "Default Dashboard",
    editProfile: "Edit Profile",
    appSettings: "App Settings",
    notificationSettings: "Notification Settings",
    accountActions: "Account Actions",
    clearData: "Clear App Data",
    logout: "Logout",
    version: "Version",
    notificationSound: "Notification Sound",
    vibration: "Vibration",
    dataUpdateFrequency: "Data Update Frequency",
    realTime: "Real-time",
    hourly: "Hourly",
    daily: "Daily",
    confirmLogout: "Confirm Logout",
    confirmLogoutMessage: "Are you sure you want to logout?",
    confirmClearData: "Confirm Clear Data",
    confirmClearDataMessage:
      "This will clear all your app data including alerts and notifications. This action cannot be undone.",
    dataCleared: "Data Cleared",
    dataSuccessfullyCleared: "Your app data has been successfully cleared.",
    confirmResetSettings: "Confirm Reset Settings",
    confirmResetSettingsMessage: "This will reset all settings to their default values.",
    settingsReset: "Settings Reset",
    settingsSuccessfullyReset: "Your settings have been successfully reset to defaults.",
  },
  historical: {
    title: "Historical Data",
    timeRange: "Time Range",
    chartType: "Chart Type",
    dateRange: "Date Range",
    from: "From",
    to: "To",
    compareCommodities: "Compare Commodities",
    priceHistory: "Price History",
    lineChart: "Line Chart",
    barChart: "Bar Chart",
    weekly: "Weekly",
    monthly: "Monthly",
    yearly: "Yearly",
    exportData: "Export Data",
    exportSuccess: "Data exported successfully!",
    noDataAvailable: "No data available for the selected parameters.",
    insufficientDataPoints: "Insufficient data points to render chart.",
    chartRenderingError: "Error rendering chart.",
    multipleCommodities: "Multiple Commodities",
    statistics: "Statistics",
    average: "Average",
    highest: "Highest",
    lowest: "Lowest",
    lastWeek: "Last Week",
    lastMonth: "Last Month",
    lastYear: "Last Year",
    location: "Location",
    period: "Period",
  },
  notifications: {
    title: "Notifications",
    markAsRead: "Mark as Read",
    deleteAll: "Delete All",
    filterByDate: "Filter by Date",
    filterByCommodity: "Filter by Commodity",
    filterByStatus: "Filter by Status",
    doNotDisturb: "Do Not Disturb",
    dndDescription: "Pause all notifications temporarily",
    unreadCount: "{{count}} unread notifications",
    allRead: "All notifications read",
    noNotifications: "No notifications",
    tryDifferentFilters: "Try different filters",
    filterNotifications: "Filter Notifications",
    resetFilters: "Reset Filters",
    all: "All Notifications",
    unread: "Unread",
    alerts: "Price Alerts",
    system: "System",
    allTime: "All Time",
    today: "Today",
    thisWeek: "This Week",
    thisMonth: "This Month",
    yesterday: "Yesterday",
    allCommodities: "All Commodities",
    confirmDeleteAll: "Delete All Notifications",
    confirmDeleteAllMessage: "Are you sure you want to delete all filtered notifications?",
    triggered: "Triggered",
    notTriggered: "Not Triggered",
    currentPrice: "Current Price",
    noHistory: "No history available",
  },
  auth: {
    loginTitle: "Login to Your Account",
    loginFailed: "Login failed. Please check your credentials.",
    forgotPassword: "Forgot Password?",
    noAccount: "Don't have an account?",
    registerTitle: "Create New Account",
    alreadyHaveAccount: "Already have an account?",
    fullName: "Full Name",
    fullNamePlaceholder: "Enter your full name",
    confirmPassword: "Confirm Password",
    preferredCommodity: "Preferred Commodity",
    agreeToTerms: "I agree to the",
    registrationSuccess: "Registration Successful",
    registrationSuccessMessage: "Your account has been created successfully. You can now login with your credentials.",
    registrationFailed: "Registration Failed",
    resetPassword: "Reset Password",
    forgotPasswordInstructions:
      "Enter your registered mobile number and we'll send you instructions to reset your password.",
    resetPasswordSent: "Reset Instructions Sent",
    resetPasswordSentMessage:
      "We've sent password reset instructions to your mobile number. Please check your messages.",
    backToLogin: "Back to Login",
  },
  validation: {
    allFieldsRequired: "All fields are required",
    invalidEmail: "Please enter a valid email address",
    invalidPhone: "Please enter a valid phone number",
    passwordTooShort: "Password must be at least 6 characters",
    nameRequired: "Name is required",
    phoneRequired: "Phone number is required",
    emailRequired: "Email is required",
    passwordRequired: "Password is required",
    passwordsDoNotMatch: "Passwords do not match",
    termsRequired: "You must agree to the terms and conditions",
  },
  errors: {
    general: "Something went wrong. Please try again.",
    chartLoading: "Error loading chart. Please try again.",
    dataFetch: "Error fetching data. Please check your connection and try again.",
    invalidData: "Invalid data received. Please try again later.",
  },
}

// Urdu translations
const urTranslations = {
  common: {
    appName: "زمین زرعین",
    login: "لاگ ان",
    register: "رجسٹر کریں",
    forgotPassword: "پاسورڈ بھول گئے؟",
    mobileNumber: "موبائل نمبر",
    password: "پاس ورڈ",
    email: "ای میل",
    save: "محفوظ کریں",
    cancel: "منسوخ کریں",
    delete: "حذف",
    edit: "ترمیم",
    search: "تلاش کریں",
    filter: "فلٹر",
    download: "ڈاؤنلوڈ کریں",
    viewDetails: "تفصیل دیکھیں",
    createAccount: "اکاؤنٹ بنائیں",
    contactSupport: "سپورٹ سے رابطہ کریں",
    termsAndConditions: "شرائط و ضوابط",
    privacyPolicy: "پرائیویسی پالیسی",
    loading: "لوڈ ہو رہا ہے...",
    date: "تاریخ",
    add: "شامل کریں",
    language: "ur",
    and: "اور",
    ok: "ٹھیک ہے",
  },
  dashboard: {
    title: "ڈیش بورڈ",
    currentPrice: "موجودہ قیمت",
    highestPrice: "زیادہ سے زیادہ",
    lowestPrice: "کم سے کم",
    averagePrice: "اوسط",
    commodity: "فصل",
    timePeriod: "وقت کی مدت",
    dataSource: "ڈیٹا کا ذریعہ",
    exportData: "ڈاٹا ڈاؤنلوڈ کریں",
    setAlert: "الرٹ سیٹ کریں",
    viewHistorical: "تاریخی ڈیٹا دیکھیں",
    viewForecast: "پیشگوئی دیکھیں",
    day: "دن",
    week: "ہفتہ",
    month: "مہینہ",
    year: "سال",
    priceHistory: "قیمت کی تاریخ",
  },
  forecast: {
    title: "قیمت پیشگوئی",
    predictedPrice: "متوقع قیمت",
    confidenceInterval: "اعتماد کا وقفہ",
    forecastDuration: "پیشگوئی کی مدت",
    days: "دن",
    weeks: "ہفتے",
    months: "مہینے",
    compareHistorical: "تاریخی ڈیٹا سے موازنہ کریں",
    downloadReport: "رپورٹ ڈاؤنلوڈ کریں",
    showConfidenceInterval: "اعتماد کا وقفہ دکھائیں",
    forecastDetails: "پیشگوئی کی تفصیلات",
    confidenceMin: "کم سے کم",
    confidenceMax: "زیادہ سے زیادہ",
  },
  alerts: {
    title: "قیمت الرٹس",
    addAlert: "الرٹ شامل کریں",
    editAlert: "الرٹ میں ترمیم کریں",
    deleteAlert: "الرٹ حذف کریں",
    priceThreshold: "قیمت کی حد",
    notificationMethod: "اطلاع کا طریقہ",
    push: "پش نوٹیفیکیشن",
    sms: "ایس ایم ایس",
    email: "ای میل",
    enableAlert: "الرٹ فعال کریں",
    disableAlert: "الرٹ غیر فعال کریں",
    alertHistory: "الرٹ کی تاریخ",
    activeAlerts: "فعال الرٹس",
    noActiveAlerts: "کوئی فعال الرٹ نہیں ہے۔ شروع کرنے کے لیے ایک شامل کریں!",
    noAlertHistory: "ابھی تک کوئی الرٹ تاریخ نہیں ہے۔",
    condition: "شرط",
    above: "سے اوپر",
    below: "سے نیچے",
    createdOn: "تاریخ تخلیق",
    triggeredOn: "متحرک ہونے کی تاریخ",
    actualPrice: "اصل قیمت",
    triggered: "متحرک",
    recreate: "الرٹ دوبارہ بنائیں",
    confirmDelete: "الرٹ حذف کریں",
    confirmDeleteMessage: "کیا آپ واقعی اس الرٹ کو حذف کرنا چاہتے ہیں؟",
    validationError: "توثیق کی خرابی",
    allFieldsRequired: "براہ کرم تمام ضروری فیلڈز کو پُر کریں۔",
    selectCommodity: "ایک فصل منتخب کریں",
    currentPrice: "موجودہ قیمت",
    notificationMethods: "اطلاع کے طریقے",
    disabled: "غیر فعال",
    enterThreshold: "براہ کرم قیمت کی حد درج کریں",
    saveAlert: "الرٹ محفوظ کریں",
    updateAlert: "الرٹ اپڈیٹ کریں",
    alertDetails: "الرٹ کی تفصیلات",
    savedAlerts: "محفوظ الرٹس",
    notifyMe: "مجھے اطلاع دیں جب",
    notifyMeWhen: "مجھے اطلاع دیں جب قیمت جائے",
    enabledStatus: "الرٹ کی حالت",
    enabled: "فعال",
    priceGoes: "قیمت جائے",
    selectNotificationMethods: "اطلاع کے طریقے منتخب کریں",
    setNewAlert: "نیا الرٹ سیٹ کریں",
    notActive: "غیر فعال",
    active: "فعال",
    save: "محفوظ کریں",
    close: "بند کریں",
    addNotification: "اطلاع شامل کریں",
    at: "پر",
    triggerStatus: "ٹرگر کی حالت",
    notTriggered: "غیر متحرک",
    lastChecked: "آخری چیک",
    price: "قیمت",
    status: "حالت",
  },
  settings: {
    title: "ترتیبات",
    language: "زبان",
    accountInfo: "اکاؤنٹ کی معلومات",
    notificationPreferences: "نوٹیفیکیشن ترجیحات",
    defaultCommodity: "ڈیفالٹ فصل",
    defaultView: "ڈیفالٹ ویو",
    resetSettings: "ترتیبات ری سیٹ کریں",
    defaultDashboard: "ڈیفالٹ ڈیش بورڈ",
    editProfile: "پروفائل میں ترمیم کریں",
    appSettings: "ایپ کی ترتیبات",
    notificationSettings: "نوٹیفیکیشن کی ترتیبات",
    accountActions: "اکاؤنٹ کے اقدامات",
    clearData: "ایپ ڈیٹا صاف کریں",
    logout: "لاگ آؤٹ",
    version: "ورژن",
    notificationSound: "نوٹیفیکیشن آواز",
    vibration: "وائبریشن",
    dataUpdateFrequency: "ڈیٹا اپڈیٹ کی تعدد",
    realTime: "حقیقی وقت",
    hourly: "گھنٹہ وار",
    daily: "روزانہ",
    confirmLogout: "لاگ آؤٹ کی تصدیق کریں",
    confirmLogoutMessage: "کیا آپ واقعی لاگ آؤٹ کرنا چاہتے ہیں؟",
    confirmClearData: "ڈیٹا صاف کرنے کی تصدیق کریں",
    confirmClearDataMessage:
      "یہ آپ کے تمام ایپ ڈیٹا بشمول الرٹس اور نوٹیفیکیشنز کو صاف کر دے گا۔ یہ عمل واپس نہیں کیا جا سکتا۔",
    dataCleared: "ڈیٹا صاف ہو گیا",
    dataSuccessfullyCleared: "آپ کا ایپ ڈیٹا کامیابی سے صاف کر دیا گیا ہے۔",
    confirmResetSettings: "ترتیبات ری سیٹ کرنے کی تصدیق کریں",
    confirmResetSettingsMessage: "یہ تمام ترتیبات کو ان کی ڈیفالٹ قیمتوں پر ری سیٹ کر دے گا۔",
    settingsReset: "ترتیبات ری سیٹ",
    settingsSuccessfullyReset: "آپ کی ترتیبات کامیابی سے ڈیفالٹ پر ری سیٹ کر دی گئی ہیں۔",
  },
  historical: {
    title: "تاریخی ڈیٹا",
    timeRange: "وقت کی حد",
    chartType: "چارٹ کی قسم",
    dateRange: "تاریخ کی حد",
    from: "سے",
    to: "تک",
    compareCommodities: "اجناس کا موازنہ کریں",
    priceHistory: "قیمت کی تاریخ",
    lineChart: "لائن چارٹ",
    barChart: "بار چارٹ",
    weekly: "ہفتہ وار",
    monthly: "ماہانہ",
    yearly: "سالانہ",
    exportData: "ڈیٹا برآمد کریں",
    exportSuccess: "ڈیٹا کامیابی سے برآمد ہو گیا",
    noDataAvailable: "منتخب مدت کے لیے کوئی ڈیٹا دستیاب نہیں ہے",
    insufficientDataPoints: "چارٹ دکھانے کے لیے کافی ڈیٹا پوائنٹس نہیں ہیں",
    chartRenderingError: "چارٹ رینڈرنگ میں خرابی۔ براہ کرم دوبارہ کوشش کریں۔",
    multipleCommodities: "متعدد اجناس",
    statistics: "شماریات",
    average: "اوسط",
    highest: "زیادہ سے زیادہ",
    lowest: "کم سے کم",
    lastWeek: "آخری ہفتہ",
    lastMonth: "آخری مہینہ",
    lastYear: "آخری سال",
    location: "موقع",
    period: "مدت",
  },
  notifications: {
    title: "نوٹیفیکیشنز",
    markAsRead: "پڑھا ہوا نشان زد کریں",
    deleteAll: "سب حذف کریں",
    filterByDate: "تاریخ سے فلٹر کریں",
    filterByCommodity: "فصل سے فلٹر کریں",
    filterByStatus: "حالت سے فلٹر کریں",
    doNotDisturb: "ڈو ناٹ ڈسٹرب",
    dndDescription: "عارضی طور پر تمام نوٹیفیکیشنز روکیں",
    unreadCount: "{{count}} ناخواندہ نوٹیفیکیشنز",
    allRead: "تمام نوٹیفیکیشنز پڑھی گئیں",
    noNotifications: "کوئی نوٹیفیکیشن نہیں",
    tryDifferentFilters: "مختلف فلٹرز آزمائیں",
    filterNotifications: "نوٹیفیکیشنز فلٹر کریں",
    resetFilters: "فلٹرز ری سیٹ کریں",
    all: "تمام نوٹیفیکیشنز",
    unread: "ناخواندہ",
    alerts: "قیمت الرٹس",
    system: "سسٹم",
    allTime: "تمام وقت",
    today: "آج",
    thisWeek: "اس ہفتے",
    thisMonth: "اس مہینے",
    yesterday: "کل",
    allCommodities: "تمام فصلیں",
    confirmDeleteAll: "تمام نوٹیفیکیشنز حذف کریں",
    confirmDeleteAllMessage: "کیا آپ واقعی تمام فلٹر شدہ نوٹیفیکیشنز کو حذف کرنا چاہتے ہیں؟",
    triggered: "متحرک",
    notTriggered: "غیر متحرک",
    currentPrice: "موجودہ قیمت",
    noHistory: "کوئی تاریخ دستیاب نہیں",
  },
  auth: {
    loginTitle: "اپنے اکاؤنٹ میں لاگ ان کریں",
    loginFailed: "لاگ ان ناکام ہوگیا۔ براہ کرم اپنی تفصیلات چیک کریں۔",
    forgotPassword: "پاسورڈ بھول گئے؟",
    noAccount: "اکاؤنٹ نہیں ہے؟",
    registerTitle: "نیا اکاؤنٹ بنائیں",
    alreadyHaveAccount: "پہلے سے ہی اکاؤنٹ ہے؟",
    fullName: "پورا نام",
    fullNamePlaceholder: "اپنا پورا نام درج کریں",
    confirmPassword: "پاس ورڈ کی تصدیق کریں",
    preferredCommodity: "پسندیدہ فصل",
    agreeToTerms: "میں متفق ہوں",
    registrationSuccess: "رجسٹریشن کامیاب",
    registrationSuccessMessage: "آپ کا اکاؤنٹ کامیابی سے بنایا گیا ہے۔ آپ اب اپنی تفصیلات سے لاگ ان کر سکتے ہیں۔",
    registrationFailed: "رجسٹریشن ناکام",
    resetPassword: "پاس ورڈ ری سیٹ کریں",
    forgotPasswordInstructions:
      "اپنا رجسٹرڈ موبائل نمبر درج کریں اور ہم آپ کو پاس ورڈ ری سیٹ کرنے کی ہدایات بھیجیں گے۔",
    resetPasswordSent: "ری سیٹ ہدایات بھیج دی گئیں",
    resetPasswordSentMessage:
      "ہم نے آپ کے موبائل نمبر پر پاس ورڈ ری سیٹ کرنے کی ہدایات بھیج دی ہیں۔ براہ کرم اپنے پیغامات چیک کریں۔",
    backToLogin: "لاگ ان پر واپس جائیں",
  },
  validation: {
    allFieldsRequired: "تمام فیلڈز ضروری ہیں",
    invalidEmail: "براہ کرم ایک درست ای میل ایڈریس درج کریں",
    invalidPhone: "براہ کرم ایک درست فون نمبر درج کریں",
    passwordTooShort: "پاس ورڈ کم از کم 6 حروف کا ہونا چاہیے",
    nameRequired: "نام ضروری ہے",
    phoneRequired: "فون نمبر ضروری ہے",
    emailRequired: "ای میل ضروری ہے",
    passwordRequired: "پاس ورڈ ضروری ہے",
    passwordsDoNotMatch: "پاس ورڈز مماثل نہیں ہیں",
    termsRequired: "آپ کو شرائط و ضوابط سے متفق ہونا ضروری ہے",
  },
  errors: {
    general: "کچھ غلط ہو گیا ہے۔ براہ کرم دوبارہ کوشش کریں۔",
    chartLoading: "چارٹ لوڈ کرنے میں خرابی۔ براہ کرم دوبارہ کوشش کریں۔",
    dataFetch: "ڈیٹا حاصل کرنے میں خرابی۔ براہ کرم اپنے کنکشن کی جانچ کریں اور دوبارہ کوشش کریں۔",
    invalidData: "غلط ڈیٹا موصول ہوا۔ براہ کرم بعد میں دوبارہ کوشش کریں۔",
  },
}

// Initialize i18next
const initI18n = async () => {
  // Get stored language preference
  let storedLanguage = null
  try {
    storedLanguage = await AsyncStorage.getItem("language")
  } catch (error) {
    console.warn("Failed to get stored language:", error)
  }

  // Initialize i18next
  await i18n.use(initReactI18next).init({
    compatibilityJSON: "v3", // Add this line for Android compatibility
    resources: {
      en: { translation: enTranslations },
      ur: { translation: urTranslations },
    },
    lng: storedLanguage || (Localization.locale.startsWith("ur") ? "ur" : "en"),
    fallbackLng: "en",
    interpolation: {
      escapeValue: false,
    },
    react: {
      useSuspense: false, // This is important for React Native
    },
  })

  return i18n
}

// Initialize i18n
initI18n().catch(console.error)

export default i18n

